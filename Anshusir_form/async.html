<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Promise, Async and Await</title>
</head>
<body>
<script type="module">
    
    let promise1 =await new Promise(function(res,rej){
        let rand = Math.floor(Math.random() * 100);
        if(rand > 50){
            setTimeout(()=>rej(rand),500);
            console.log(rand);
        }else{
            setTimeout(()=>res(rand),500);
            console.log(rand);

        }
    });
    let promise2 = new Promise(function(res,rej){
        let rand = Math.floor(Math.random() * 100);
        if(rand > 50){
            setTimeout(()=>rej(rand),1000);
            console.log(rand);
        }else{
            setTimeout(()=>res(rand),1000);
            console.log(rand);
        }
    });
    let promise3 = new Promise(function(res,rej){
        let rand = Math.floor(Math.random() * 100);
        if(rand > 50){
            setTimeout(()=>rej(rand),2000);
            console.log(rand);
        }else{
            setTimeout(()=>res(rand),2000);
            console.log(rand);
        }
    });


    Promise.race([promise1,promise2,promise3]).then((values) => {
        console.log(values);
    }).catch(()=> {
        console.log("Error Occure");
    }).finally(()=> {
        console.log("Succesfully Finish Race");
    });
    
    Promise.all([promise1,promise2,promise3]).then((values) => {
        console.log(values);
    }).catch(()=> {
        console.log("Error Occure");
    }).finally(()=> {
        console.log("Succesfully Finish This Process");
    });


    Promise.any([promise1,promise2,promise3]).then((values) => {
        console.log(values);
    }).catch(()=> {
        console.log("Error Occure");
    }).finally(()=> {
        console.log("Succesfully Finish AnyOne Process");
    });

    




    // function delayWithRandomReject(mili) {
    //     const rand = Math.floor(Math.random() * 100);
    //     console.log('Rand =', rand);
    //     return new Promise((res , rej) => {
    //         setTimeout(() => {
    //             if(rand < 20) {
    //                 rej(mili);
    //             } else {
    //                 res(mili);
    //             }
    //         }, mili);
    //     });
    // }

    // delayWithRandomReject(1000).then(v => {
    //     delayWithRandomReject(v + 500).then(
    //         val => console.log(val)
    //     ).catch(() => {
    //         console.log('delay 2 failed')
    //     });
    // }).catch(() => {
    //     console.log('delay 1 failed');
    // });

    // let d1 = await delayWithRandomReject(1000).catch(() => {
    //     console.log('delay 1 failed');
    //     return null;
    // });
    // if(d1 !== null) {
    //     let d2 = await delayWithRandomReject(d1 + 500).catch(() => {
    //         console.log('delay 2 failed');
    //         return null;
    //     });
    //     console.log('value', d2);
    // }

    // function delayWithValue(mili) {
    //     return new Promise((res , rej) => {
    //         setTimeout(() => {
    //             res(mili);
    //         }, mili);
    //     });
    // }

    // let d1 = await delayWithValue(1000);
    // console.log('value d1', d1);
    // let d2 = await delayWithValue(d1 + 500);
    // console.log('value d2', d2);

    // function delay(mili) {
    //     return new Promise(res => {setTimeout(res, mili)});
    // }

</script>
</body>
</html>